<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'" />
    <title>Game Launcher</title>
    <style>
      body { margin: 0; font-family: sans-serif; background: #2e3440; color: #fff; }
      .layout { display: grid; grid-template-columns: 3fr 1fr; height: 100vh; }
      .left { padding: 12px; border-right: 1px solid #4c566a; }
      .right { padding: 12px; }
      h2 { margin: 0 0 8px 0; }
      table { width: 100%; border-collapse: collapse; }
      th, td { text-align: left; padding: 6px 8px; border-bottom: 1px solid #3b4252; }
      tr:hover { background: #3b4252; }
    </style>
  </head>
  <body>
    <div class="layout">
      <div class="left">
        <h2>Panel: Games List</h2>
        <div>
          <input id="search" placeholder="Search" style="width:60%" />
          <button id="refresh">Refresh</button>
        </div>
        <table id="games">
          <thead>
            <tr><th>⭐</th><th>Name</th><th>Type</th><th>Rating</th><th>Tags</th><th>Last Played</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="right">
        <h2>Panel: Details</h2>
        <div id="details">Select a game…</div>
      </div>
    </div>
    <script>
      async function callBackend(command, args=[]) {
        // Tauri invoke
        return await window.__TAURI__.invoke('call_backend', { command, args });
      }
      async function loadGames() {
        try {
          const out = await callBackend('get_games', []);
          const data = JSON.parse(out);
          const tbody = document.querySelector('#games tbody');
          tbody.innerHTML = '';
          if (data.success && Array.isArray(data.games)) {
            data.games.forEach((g, idx) => {
              const tr = document.createElement('tr');
              tr.innerHTML = `<td>${g.is_favorite ? '⭐' : ''}</td><td>${g.name||''}</td><td>${g.game_type||''}</td><td>${g.rating??'N/A'}</td><td>${(g.tags||[]).join(', ')}</td><td>${g.last_played||''}</td>`;
              tr.addEventListener('click', () => showDetails(g));
              tbody.appendChild(tr);
            });
          }
        } catch (e) { console.error(e); }
      }
      function showDetails(g) {
        const d = document.getElementById('details');
        d.innerHTML = `<div><div><b>Name:</b> ${g.name||''}</div><div><b>Type:</b> ${g.game_type||''}</div><div><b>Rating:</b> ${g.rating??'N/A'}</div><div><b>Tags:</b> ${(g.tags||[]).join(', ')}</div><div><b>Last Played:</b> ${g.last_played||''}</div><div style='margin-top:10px;'><b>Summary:</b><br>${g.summary||''}</div></div>`;
      }
      document.getElementById('refresh').addEventListener('click', loadGames);
      window.addEventListener('DOMContentLoaded', loadGames);
    </script>
  </body>
  </html>


